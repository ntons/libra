version: "3.9"

services:
  mongo:
    image: mongo:4.0-xenial
    volumes:
    - ./mongo/db:/data/db
    - ./mongo/configdb:/data/configdb

  redis:
    image: redis:4.0-alpine
    volumes:
    - ./redis/data:/data

  librad:
    image: ntons/librad:0.0.1
    depends_on:
    - mongo
    - redis
    volumes:
    - ./librad/librad.yaml:/etc/librad.yaml

  edgeproxy:
    image: envoyproxy/envoy-alpine:v1.16-latest
    init: true
    depends_on:
    - librad
    ports:
    - "30080:80"
    volumes:
    - ./edgeproxy/envoy:/etc/envoy

  apiproxy:
    image: envoyproxy/envoy-alpine:v1.16-latest
    init: true
    depends_on:
    - librad
    ports:
    - "31080:80"
    volumes:
    - ./apiproxy/envoy:/etc/envoy
